# Evaluation of influenza A/H3N2 epidemiology in England during the 2025-26 season
This repository contains all of the code and data required to reproduce the analyses presented in the accompanying [manuscript]((https://zenodo.org/records/17704679).

The analyses should be run in order using the numbered files in the `scripts` folder. Most R packages used are standard, listed at the top of each script, and can be installed from CRAN. However, the [EpiStrainDynamics](https://github.com/acefa-hubs/EpiStrainDynamics/tree/main) package requires some custom input to solve an issue currently raised [here](https://github.com/acefa-hubs/EpiStrainDynamics/issues/34).

Please download the [EpiStrainDynamics](https://github.com/acefa-hubs/EpiStrainDynamics/tree/main) package locally and replace L236 in `R/post_fit_calc.R`:

`a <- transform_posterior_multi(post, B_true, components$num_path, components$num_days)`

with:

`a <- transform_posterior_single(post, B_true, components$num_days)`

All graphical outputs are saved to the `figures` folder, and tables of results are saved either to the `figures` folder or the `results` folder.

The results from the scenario analyses presented in the main text are saved in the `scenarios` folder and are extracted using the scripts `4.combine_scenario_plots.R` and `5.combine_scenario_tables.R`.


# Seasonal influenza H3N2 scenario analysis.

This repo provides analysis and code used to explore and model seasonal H3N2 influenza outbreaks occurring in England, whilst accounting for UK half-term and Christmas holidays alongside measures of immune susceptibility and transmission. Scenario analysis was performed using an age-stratified SIR model that draws contact frequencies from the POLYMOD study using the [`socialmixr`](<https://github.com/epiforecasts/socialmixr>) R package.

For full details please see our pre-print:

[Link to zenodo](https://zenodo.org/records/17704679)

DOI - https://doi.org/10.5281/zenodo.17704679

The easiest way to run the model is to visit the Shiny app hosted at:

<https://hay-idd.shinyapps.io/ModelFluUk-H3N2/>

You can also run the app locally by running the app.R file in the `ModelFluUk-H3N2` directory.

The app allows users to modify various parameters and explore the resulting impact on flu timing, epidemic size and peak incidence across age groups. The parameters which can be modified are explained below:

## Core

- **`Basic reproductive number R0`** *(float, default = 1.9)*  
  Average number of secondary infections generated by one infectious individual in a fully susceptible population.

- **`Infectious period (days) gamma`** *(float, default = 4.5)*  
  Average duration (in days) that an individual remains infectious.

- **`Overall immune escape`** *(float, default = 1)*  
  Multiplier on existing immunity. Lower values correspond to greater antigenic drift and reduced protection.

- **`Seed size`** *(integer, default = 1000)*  
  Number of initial infections introduced into the population at the start of the simulation.

- **`Seed date`** *(date, default = 2022-09-19)*  
  Date on which initial infections are introduced.

- **`Simulation end date`** *(date, default = 2023-03-01)*  
  Final date of the model simulation window.

- **`Reporting rate`** *(float, default = 0.008)*  
  Fraction of symptomatic cases that are reported.

---

## Plot options

- **`Maximum y-axis value`** *(numeric, default = 4000)*  
  Upper limit for the y-axis in epidemic plots.

- **`Growth plot y-scale (symmetric)`** *(float, default = 1.5)*  
  Scaling factor applied to the y-axis for growth rate plots.

- **`Plot start date`** *(date, default = 2022-10-01)*  
  Starting date for the visualised plot window.

---

## Demographics and contact patterns

- **`Population Size`** *(numeric, default = 60000000)*  
  Total population size used in the model.

### School holiday contacts

- **`Multiplier for home contacts in breaks`** *(float, default = 1)*  
  Scaling factor applied to home contacts during school holidays.

- **`Proportion of work contacts kept in school holidays`** *(float, default = 0.75)*  
  Fraction of usual work contacts retained during school holidays.

- **`Multiplier for non-school or work contacts in breaks`** *(float, default = 1.1)*  
  Scaling factor for other (non-school, non-work) contacts during school holidays.

### Christmas period contacts (before school holiday)

- **`Multiplier for all non-school contacts in Christmas period`** *(float, default = 1.25)*  
  Scaling factor applied to all non-school contacts during the pre-Christmas period.

### Christmas holiday contacts

- **`Proportion of all contacts kept over Christmas`** *(float, default = 0.7)*  
  Fraction of total contacts maintained over the Christmas holiday period.

- **`Multiplier for home contacts over Christmas holiday`** *(float, default = 3)*  
  Increase factor applied to home contacts over the Christmas holidays.

---

## Immunity and disease

### Baseline immunity by age group

- **`Proportion immune (0–4 yrs)`** *(float, default = 0.35)*  
  Fraction of individuals aged 0–4 with pre-existing immunity.

- **`Proportion immune (5–18 yrs)`** *(float, default = 0.6)*  
  Fraction of individuals aged 5–18 with pre-existing immunity.

- **`Proportion immune (19–64 yrs)`** *(float, default = 0.7)*  
  Fraction of individuals aged 19–64 with pre-existing immunity.

- **`Proportion immune (65+ yrs)`** *(float, default = 0.7)*  
  Fraction of individuals aged 65+ with pre-existing immunity.

### Symptomatic fraction by age group

- **`Symptomatic frac (0–4 yrs)`** *(float, default = 0.05)*  
  Proportion of infected individuals aged 0–4 who develop symptoms.

- **`Symptomatic frac (5–18 yrs)`** *(float, default = 0.2)*  
  Proportion of infected individuals aged 5–18 who develop symptoms.

- **`Symptomatic frac (19–64 yrs)`** *(float, default = 0.3)*  
  Proportion of infected individuals aged 19–64 who develop symptoms.

- **`Symptomatic frac (65+ yrs)`** *(float, default = 0.5)*  
  Proportion of infected individuals aged 65+ who develop symptoms.


